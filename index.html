<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CBCN Study Quiz</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body {
      font-family: system-ui, sans-serif;
      margin: 0;
      padding: 0;
      background: var(--bg);
      color: var(--text);
      transition: background .3s, color .3s;
    }
    :root {
      --bg: #ffffff;
      --text: #111;
      --panel: #f7f7f7;
    }
    html.light {
      --bg: #fff;
      --text: #111;
      --panel: #f6f6f6;
    }
    html:not(.light) {
      --bg: #1c1c1c;
      --text: #f1f1f1;
      --panel: #2a2a2a;
    }
    header {
      padding: .75rem 1rem;
      background: var(--panel);
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: sticky;
      top: 0;
      z-index: 2;
    }
    header h1 { font-size: 1.2rem; margin: 0; }
    main { padding: 1rem; max-width: 800px; margin: auto; }
    .tabs { display: flex; gap: .5rem; margin-bottom: 1rem; }
    .tabs button {
      padding: .4rem .8rem; border: none; cursor: pointer;
      background: var(--panel); color: var(--text); border-radius: .4rem;
    }
    .tabs button.active { background: #6a5acd; color: #fff; }
    .view { display: none; }
    .view.active { display: block; }
    .tag { background: #6a5acd; color: #fff; padding: 2px 6px; border-radius: 6px; font-size: .8rem; margin-right: 4px; }
    .badge { display: inline-block; padding: 3px 6px; border-radius: 4px; font-size: .8rem; }
    .badge.ok { background: #4CAF50; color: white; }
    .badge.no { background: #E53935; color: white; }
    .muted { opacity: .8; }
    .hidden { display: none; }
    #choices label { display:block; margin:6px 0; }
    #feedback { background: var(--panel); padding:.75rem; border-radius:6px; margin-top:1rem; }
    #badges { margin-top:.5rem; }
    .stats { display:flex; gap:1rem; font-size:.9rem; margin-top:.75rem; }
    .pack-controls {
      background: var(--panel);
      padding: .5rem .75rem;
      border-radius: .5rem;
      margin-bottom: .75rem;
      display:flex;
      flex-wrap:wrap;
      gap:1rem;
      align-items:center;
    }
    .pack-controls label { display:inline-flex; gap:.4rem; align-items:center; cursor:pointer; }
    button { cursor:pointer; }
    #filterBar { display:flex; gap:.5rem; flex-wrap:wrap; align-items:center; margin-bottom:1rem; }
    input, select { padding:.3rem; border-radius:.3rem; border:1px solid #ccc; }
    #bankList .item, #historyList .item {
      background: var(--panel);
      margin-bottom:.5rem;
      padding:.5rem .75rem;
      border-radius:.4rem;
    }
  </style>
</head>
<body>
  <header>
    <h1>ü©∫ CBCN Study Quiz</h1>
    <div id="themeToggle">
      <label style="font-size:.9rem;cursor:pointer;">
        <input type="checkbox" id="optDark" checked> Dark Mode
      </label>
    </div>
  </header>

  <main>
    <!-- PACK SELECTION -->
    <div id="packControls"></div>

    <!-- NAVIGATION TABS -->
    <div class="tabs">
      <button class="active" data-view="quiz">Quiz</button>
      <button data-view="bank">Question Bank</button>
      <button data-view="history">History</button>
      <button data-view="settings">Settings</button>
    </div>

    <!-- QUIZ VIEW -->
    <div id="view-quiz" class="view active">
      <div id="filterBar">
        <label>Domain:
          <select id="filterDomain"><option>All</option></select>
        </label>
        <label>Tags:
          <input id="filterTags" type="text" placeholder="Comma-separated tags...">
        </label>
        <button id="reshuffleBtn">Shuffle</button>
        <button id="resetBtn">Reset Session</button>
      </div>

      <div id="meta" class="muted sm"></div>
      <div id="badges"></div>
      <h2 id="stem"></h2>
      <div id="choices"></div>

      <div class="stats">
        <span>‚úÖ <b id="statCorrect">0</b></span>
        <span>‚ùå <b id="statIncorrect">0</b></span>
        <span>üî• <b id="statStreak">0</b></span>
        <span>üìö <b id="statBank">0</b></span>
        <span>üî¢ <b id="counter"></b></span>
      </div>

      <div style="margin-top:1rem;">
        <button id="submitBtn">Submit</button>
        <button id="revealBtn">Reveal</button>
        <button id="nextBtn" class="hidden">Next</button>
        <button id="bookmarkBtn">‚òÖ Bookmark</button>
      </div>

      <div id="feedback" class="hidden">
        <div id="resultBadge" class="badge"></div>
        <p id="rationale" style="margin:.5rem 0;"></p>
        <ul id="whyWrong"></ul>
      </div>
    </div>

    <!-- BANK VIEW -->
    <div id="view-bank" class="view">
      <h2>All Questions</h2>
      <div id="bankList"></div>
    </div>

    <!-- HISTORY VIEW -->
    <div id="view-history" class="view">
      <h2>Answer History</h2>
      <p id="historyEmpty" class="muted">No answers saved yet.</p>
      <div id="historyList"></div>
      <div style="margin-top:1rem;">
        <button id="exportBtn">Export CSV</button>
        <button id="clearHistoryBtn">Clear History</button>
      </div>
    </div>

    <!-- SETTINGS VIEW -->
    <div id="view-settings" class="view">
      <h2>Settings</h2>
      <label><input type="checkbox" id="optShuffle" checked> Shuffle Questions</label><br>
      <label><input type="checkbox" id="optPersist" checked> Save Answer History</label><br>
      <label><input type="checkbox" id="optDark" checked> Dark Mode</label><br><br>
      <button id="clearBookmarksBtn">Clear Bookmarks</button>
      <h3>Bookmarked Questions</h3>
      <div id="bookmarkList" class="muted sm"></div>
    </div>
  </main>

  <script src="script.js"></script>
</body>
</html>
